*** Settings ***
Library		Selenium2Library
Library		String
Library		Collections	
Variables	Variables/Variables.py
Resource	../Common/Common_Variables.txt
Suite Setup		Open Makemytrip


*** Test Cases ***
Search Hotels Functionality
	Set Selenium Speed	4 seconds
	Search Hotels For Destination
	Check Hotels According to Destination					

Check Popular Filters For Destination
	Set Selenium Speed	5 seconds
	Click Element		${Blank}
	Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	${PopularFilterSection}		${allFilters[0]}	${popularFiltersList}	${PopularFilterNum}		${PopularCheckBox}		${PopularFilterShowmore}	${PopularFilter}	${PopularFilterValue}

Check Price Per Night Filter For Destination
	Set Selenium Speed	5 seconds
	Click Element		${Blank}
	Select Price Per Night And Check Hotels According To Filter		

Check Locality Filters For Destination		
	Set Selenium Speed	5 seconds
	Click Element		${Blank}	
	Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	${LocalityFilterSection}	${allFilters[1]}	${localityFilterList}	${LocalityFilterNum}		${LocalityCheckBox}		${LocalityFilterShowmore}	${LocalityFilter}	${LocalityFilterValue}

Check Star Category Filters For Destination
	Set Selenium Speed	5 seconds
	Click Element		${Blank}	
	Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	${StarCategorySection}		${allFilters[2]}	${starCategoryFilterList}	${StarCategoryFilterNum}		${StarCategoryCheckBox}		${StarCategoryShowmore}		${StarCategoryFilter}		${StarCategoryFilterValue}

Check Property Types Filters For Destination
	Set Selenium Speed	5 seconds
	Click Element		${Blank}	
	Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	${PropertyTypeSection}		${allFilters[4]}	${propertyTypeList}		${PropertyTypeFilterNum}		${PropertyTypeCheckBox}		${PropertyTypeShowmore}		${PropertyTypeFilter}		${PropertyTypeFilterValue}


Check User Rating Filters For Destination
	Set Selenium Speed	5 seconds
	Click Element		${Blank}	
	Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	${UserRatingFilterSection}	${allFilters[3]}	${userRatingList}		${UserRatingFilterNum}		${UserRatingCheckBox}	${UserRatingFilterShowmore}		${UserRatingFilter}		${UserRatingFilterValue}

Check Facility Filters For Destination
	Set Selenium Speed	5 seconds
	Click Element		${Blank}	
	Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	${FacilityFilterSection}	${allFilters[5]}	${facilityFilterList}	${FacilityFilterNum}		${FacilityCheckBox}		${FacilityFilterShowmore}	${FacilityFilter}		${FacilityFilterValue}



*** Keywords ***
Open Makemytrip
	Open Browser	${url}		${browser}		#remote_url=http://192.168.43.6:4444/wd/hub		desired_capabilities={"browserName":"firefox","platform":"WINDOWS"}
	Maximize Browser Window
	
Search Hotels For Destination
	Click Element	${LoginButton}
	Click Element	${HotelButton}
	Click Element	${DestiName}
	Input Text		${EnterDesti}	${Destination}
	Click Element	${SelectDesti}
	Click Element	${CheckInDate}
	Click Element	${CheckOutDate}
	Click Element	${RoomGuest}
	${numa}=	Convert To String	${adultsnum}
	${Adults}=	Replace String	${Adults}	NUMA	${numa}
	Click Element	${Adults}
	${numc}=	Convert To String	${childsnum}
	${Childs}=	Replace String	${Childs}	NUMC	${numc}	
	Click Element	${Childs}
	: FOR	${child_num}	IN RANGE	0	${childsnum}	
	\	${child}=	Convert To String	${child_num}
	\	${Child_Age}=	Replace String	${ChildAge}		CHILD		${child}
	\	${age}=		Convert To String	${age${child_num}}
	\	${ChildAge_Value}=	Replace String	${ChildAgeValue}	AGE		${age}
	\	${ChildAge_Value}=	Replace String	${ChildAge_Value}	CHILD		${child}	
	\	Click Element	${ChildAge}
	\	Click Element   ${ChildAgeValue}
	\	${child_num}=	Evaluate	${child_num} + 1
	\	${childAge}=	Replace String	${childAge}		${child}		CHILD	
	\	${ChildAge_Value}=	Replace String	${ChildAgeValue}	${age}		AGE
	\	${ChildAge_Value}=	Replace String	${ChildAge_Value}	${child}	CHILD	

	Click Element	${ApplyButton}
	Click Element	${TravellingReason}
	Click Element	${TravellingForLeisure}
	Click Element	${SerachButton}
	
Check Hotels According to Destination
#	Click Element		${Blank}
	${countHotels}=		Get Element Count	${HotelsLists}	
	:FOR	${singleHotel}	IN RANGE	2	${countHotels}+2
	\	${row}=		Convert To String	${singleHotel}
	\	${CheckDesti}=	Replace String		${CheckDesti}	ROW		${row}
 	\	Element Should Contain		${CheckDesti}		${Destination}
	\	${singleHotel}=	Evaluate	${singleHotel}+1
	\	${CheckDesti}=	Replace String		${CheckDesti}	${row}		ROW

	

Select Filter From "Select filter" And Check Checkbox Is Clickable Or Not	
	[Arguments]		${FilterSection}	${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}		${FilterShowMore}		${Filters}		${FilterValue}
	${showmore}=	Run Keyword And Return Status	Page Should Contain Element		${FilterShowMore}
	Run Keyword If		${showmore}==True	Click Element	${FilterShowMore}
	${totalSection}=	Get Element Count	${FilterSection}
	Run Keyword If		${totalSection}>1	Select Filter From More Than One Sections		${totalSection}		${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}			${Filters}		${FilterValue}
	...		ELSE	Select Filter From Single Section		${totalSection}		${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}			${Filters}		${FilterValue}
	
Select Filter From Single Section
	[Arguments]		${totalSection}		${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}		${Filters}		${FilterValue}
	${totalFilter}=	Get Element Count	${Filters}
	: FOR	${filter}		IN RANGE	1	${totalFilter}+1
	\	${num}=		Convert To String	${filter}
	\	Log		${FilterNum}
	\	${Filter_Num}=	Replace String		${FilterNum}	FILTERNUM		${num}	
	\	${Filter_Value}=	Replace String		${FilterValue}		FILTERNUM		${num}		
	\	Log		${Filter_Num}
	\	Log		${Filter_Value}
	\	${value}=	Get Text	${Filter_Value}
	\	Click Element	${Filter_Num}	
	\	${status}=	Run Keyword And Return Status	Element Should Contain		${Applied}		${value}
	\	Run Keyword If	${status}==True		Check Hotels According To "${selectFilterValue} Filter" For Destination		${filter}		${FiltersList}		${Filter_Num}		${value}
	\	${FilterNum}=	Replace String		${FilterNum}		${num}		FILTERNUM	
	\	${FilterValue}=	Replace String		${FilterValue}		${num}		FILTERNUM	
	\	${filter}=	Evaluate	${filter}+1				

	
Select Filter From More Than One Sections
	[Arguments]		${totalSection}		${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}		${Filters}		${FilterValue}
	: FOR	${section}		IN RANGE	1	${totalSection}+1
	\	Select Filter From Section Filter	${section}	${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}		${Filters}		${FilterValue}
	
Select Filter From Section Filter	
	[Arguments]		${section}	${selectFilterValue}	${FiltersList}		${FilterNum}		${CheckBox}		${Filters}		${FilterValue}
	${sec}=		Convert To String	${section}
	${sec_filter}=	Replace String	${Filters}		SEC		${sec}
	${totalFilter}=	Get Element Count	${sec_filter}
	: FOR	${filter}		IN RANGE	1	${totalFilter}+1
	\	${num}=		Convert To String	${filter}
	\	Log		${FilterNum}
	\	${Filter_Num}=	Replace String		${FilterNum}	FILTERNUM		${num}	
	\	${Filter_Num}=	Replace String		${Filter_Num}	SEC		${sec}
	\	${Filter_Value}=	Replace String		${FilterValue}		FILTERNUM		${num}		
	\	${Filter_Value}=	Replace String		${Filter_Value}		SEC		${sec}	
	\	Log		${Filter_Num}
	\	Log		${Filter_Value}
	\	${value}=	Get Text	${Filter_Value}
	\	Click Element	${Filter_Num}	
	\	${status}=	Run Keyword And Return Status	Element Should Contain		${Applied}		${value}
	\	Run Keyword If	${status}==True		check hotels according to "${selectFilterValue} filter" for destination		${filter}		${FiltersList}		${Filter_Num}		${value}
	\	${FilterNum}=	Replace String		${FilterNum}		${sec}		SEC			count=1	
	\	${FilterNum}=	Replace String		${FilterNum}		${num}		FILTERNUM	
	\	${FilterValue}=	Replace String		${FilterValue}		${sec}		SEC			count=1	
	\	${FilterValue}=	Replace String		${FilterValue}		${num}		FILTERNUM	
	\	${filter}=	Evaluate	${filter}+1				


Check Hotels According To "Popular Filter" For Destination
	[Arguments]		${filter}		${FiltersList}		${Filter_Num}		${value}
	${countHotels}=		Get Element Count	${HotelsLists}
	:FOR	${singleHotel}	IN RANGE	0	${countHotels}
	\	${row}=		Convert To String	${singleHotel}
	\	${CheckDesti}=	Replace String		${CheckDesti}	ROW		${row}
	
 	\	${status}=		Run Keyword And Return Status	Element Should Contain		${CheckDesti}		${FiltersList["${value}"]}
	\	Run Keyword If		${status}==False	Check Image Of "${value}" Popular Filter	${row}	${value}	
	\	...		ELSE IF		${status}==True		Element Should Contain		${CheckDesti}		${FiltersList["${value}"]}
	\	...		ELSE		Check Only Filter Hotels For That
	\	${singleHotel}=	Evaluate	${singleHotel}+1

	\	${CheckDesti}=	Replace String		${CheckDesti}	${row}		ROW
	Click Element	${AppliedFilter}		

Check Image Of "MMT Assured" Popular Filter	
	[Arguments]		${row}	${value}	
	${MMTAssuredImage}=		Replace String		${MMTAssuredImage}	ROW		${row}
	Element Should Be Visible		${MMTAssuredImage}
	${MMTAssuredImage}=		Replace String		${MMTAssuredImage}	${row}	ROW
	
Check Image Of "MySafety - Safe and Hygienic Stays" Popular Filter	
	[Arguments]		${row}	${value}	
	${MySafetyImage}=		Replace String		${MySafetyImage}	ROW		${row}
	Element Should Be Visible		${MySafetyImage}
	${MySafetyImage}=		Replace String		${MySafetyImage}	${row}	ROW
	
Check Only Filter Hotels For That
	{countHotels}=		Get Element Count	${HotelsLists}	
	
Check Hotels According To "Property Types Filter" For Destination 
	[Arguments]		${filter}		${FiltersList}		${Filter_Num}		${value}
	${valueUpper}=		convert to upper case	${value}
	${countHotels}=		Get Element Count	${HotelsLists}
	:FOR	${singleHotel}	IN RANGE	0	${countHotels}
	\	${row}=		Convert To String	${singleHotel}
	\	${CheckDesti}=	Replace String		${CheckDesti}	ROW		${row}
	\	${Banner}=	Replace String		${Banner}	ROW		${row}
 	\	${status}=		Run Keyword And Return Status	Element Should Be Visible		${Banner}		
	\	Run Keyword If		${status}==True		Element Should Contain		${CheckDesti}		${valueUpper}	ELSE	Log		Hotels
	\	${singleHotel}=	Evaluate	${singleHotel}+1
	\	${Banner}=	Replace String		${Banner}	${row}		ROW
	\	${CheckDesti}=	Replace String		${CheckDesti}	${row}		ROW
	Click Element	${AppliedFilter}		

Select Price Per Night And Check Hotels According To Filter
	Element Should Be Visible	${LastValue}
	Execute Javascript		window.scroll(0,500)
	Drag And Drop By Offset		${LastValue}	-100		0
	Execute Javascript		window.scroll(0,500)
	Drag And Drop By Offset		${InitValue}	50		0
	${MaxTargetPrice}=		Get Text	${TargetPrice}
	${MaxTargetPrice}=		Convert To String	${MaxTargetPrice}
	Log		${MaxTargetPrice}
	${maxPrice}=	Strip String		${MaxTargetPrice}		characters=INR
	Log		${maxPrice}
	${MinTargetPrice}=		Get Text	${StartingPrice}
	${MinTargetPrice}=		Convert To String	${MinTargetPrice}
	Log		${MinTargetPrice}
	${minPrice}=	Strip String		${MinTargetPrice}		characters=INR
	Log		${minPrice}

	${countHotels}=		Get Element Count	${HotelsLists}
	:FOR	${singleHotel}	IN RANGE	0	${countHotels}
	\	${row}=		Convert To String	${singleHotel}
	\	${InrPrice}=	Replace String		${InrPrice}		ROW		${row}
	\	${shownInrPrice}=		Get Text	${InrPrice}
	\	${shownInrPrice}=		Convert To String	${shownInrPrice}
	\	Log		${shownInrPrice}
	\	${price}=	Strip String		${shownInrPrice}		characters=INR
	\	Log		${price}
	\	${Legth}=	Get Length		${price}
	\	${price}=	Remove String		${price}	,
	\	Log		${price}
	\	Should Be True		${maxPrice}>=${price}
	\	Should Be True		${minPrice}<=${price}
	\	${InrPrice}=	Replace String		${InrPrice}		${row}	ROW	
	Click Element	${AppliedFilter}
	
	
Check Hotels According To "Locality filter" For Destination 
	[Arguments]		${filter}		${FiltersList}		${Filter_Num}		${value}
	${countHotels}=		Get Element Count	${HotelsLists}
	${countAfterNearBy}=	Get Element Count	${NearByHotels}
	:FOR	${singleHotel}	IN RANGE	0	${countHotels}-${countAfterNearBy}
	\	${row}=		Convert To String	${singleHotel}
	\	${CheckDesti}=	Replace String		${CheckDesti}	ROW		${row}
 	\	Element Should Contain		${CheckDesti}		${FiltersList["${value}"]}	
	\	${singleHotel}=	Evaluate	${singleHotel}+1
	\	${CheckDesti}=	Replace String		${CheckDesti}	${row}		ROW
	Click Element	${AppliedFilter}		



Check Hotels According To "Ficility filter" For Destination 
	[Arguments]		${filter}		${FiltersList}		${Filter_Num}		${value}
	Element Should Be Visible		${HotelsLists}
	${countHotels}=		Get Element Count	${HotelsLists}
	Click Element	${AppliedFilter}

	
Check Hotels According To "User Rating filter" For Destination	
	[Arguments]		${filter}		${FiltersList}		${Filter_Num}	${value1}
	${countHotels}=		Get Element Count	${HotelsLists}
	:FOR	${singleHotel}	IN RANGE	0	${countHotels}	
	\	${row}=		Convert To String	${singleHotel}
	\	${UserRating}=	Replace String		${UserRating}	ROW		${row}	
	\	${value}=	Get Text	${UserRating}
	\	Should Be True		${value}>=${FiltersList[${filter}-1]}	
	\	${singleHotel}=	Evaluate	${singleHotel}+1
	\	${UserRating}=	Replace String		${UserRating}	${row}		ROW
	Click Element	${AppliedFilter}		


Check Hotels According To "Star Category filter" For Destination 
	[Arguments]		${filter}		${FiltersList}		${Filter_Num}		${value}
	${countHotels}=		Get Element Count	${HotelsLists}
	:FOR	${singleHotel}	IN RANGE	0	${countHotels}
	\	${row}=		Convert To String	${singleHotel}
	\	${value1}=		Convert To String		${value}
	\	${Star}=		Replace String		${Stars}	ROW		${row}
	\	${Star}=		Replace String		${Star}		STAR	${FiltersList["${value1}"]}
	\	${status}=		Run Keyword And Return Status	Element Should Be Visible		${Star}		
	\	Run Keyword If		${status}==True		Log		match 
	\	${singleHotel}=	Evaluate	${singleHotel}+1
	\	${Stars}=		Replace String		${Stars}	${row}		ROW
	\	${Stars}=		Replace String		${Stars}	${FiltersList["${value1}"]}		STAR
	Click Element	${AppliedFilter}		







